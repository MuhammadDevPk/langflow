{
  "data": {
    "id": "ConditionalRouter-JcNLx",
    "node": {
      "base_classes": [
        "Message"
      ],
      "beta": false,
      "conditional_paths": [],
      "custom_fields": {},
      "description": "Routes an input message to a corresponding output based on text comparison.",
      "display_name": "If-Else",
      "documentation": "https://docs.langflow.org/components-logic#conditional-router-if-else-component",
      "edited": false,
      "field_order": [
        "input_text",
        "operator",
        "match_text",
        "case_sensitive",
        "true_case_message",
        "false_case_message",
        "max_iterations",
        "default_route"
      ],
      "frozen": false,
      "icon": "split",
      "legacy": false,
      "metadata": {},
      "minimized": false,
      "output_types": [],
      "outputs": [
        {
          "allows_loop": false,
          "cache": true,
          "display_name": "True",
          "group_outputs": true,
          "method": "true_response",
          "name": "true_result",
          "selected": "Message",
          "tool_mode": true,
          "types": [
            "Message"
          ],
          "value": "__UNDEFINED__"
        },
        {
          "allows_loop": false,
          "cache": true,
          "display_name": "False",
          "group_outputs": true,
          "method": "false_response",
          "name": "false_result",
          "selected": "Message",
          "tool_mode": true,
          "types": [
            "Message"
          ],
          "value": "__UNDEFINED__"
        }
      ],
      "pinned": false,
      "template": {
        "_type": "Component",
        "case_sensitive": {
          "_input_type": "BoolInput",
          "advanced": true,
          "display_name": "Case Sensitive",
          "dynamic": false,
          "info": "If true, the comparison will be case sensitive.",
          "list": false,
          "list_add_label": "Add More",
          "name": "case_sensitive",
          "placeholder": "",
          "required": false,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_metadata": true,
          "type": "bool",
          "value": true
        },
        "code": {
          "advanced": true,
          "dynamic": true,
          "fileTypes": [],
          "file_path": "",
          "info": "",
          "list": false,
          "load_from_db": false,
          "multiline": true,
          "name": "code",
          "password": false,
          "placeholder": "",
          "required": true,
          "show": true,
          "title_case": false,
          "type": "code",
          "value": "import re\n\nfrom langflow.custom.custom_component.component import Component\nfrom langflow.io import BoolInput, DropdownInput, IntInput, MessageInput, MessageTextInput, Output\nfrom langflow.schema.message import Message\n\n\nclass ConditionalRouterComponent(Component):\n    display_name = \"If-Else\"\n    description = \"Routes an input message to a corresponding output based on text comparison.\"\n    documentation: str = \"https://docs.langflow.org/components-logic#conditional-router-if-else-component\"\n    icon = \"split\"\n    name = \"ConditionalRouter\"\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.__iteration_updated = False\n\n    inputs = [\n        MessageTextInput(\n            name=\"input_text\",\n            display_name=\"Text Input\",\n            info=\"The primary text input for the operation.\",\n            required=True,\n        ),\n        DropdownInput(\n            name=\"operator\",\n            display_name=\"Operator\",\n            options=[\n                \"equals\",\n                \"not equals\",\n                \"contains\",\n                \"starts with\",\n                \"ends with\",\n                \"regex\",\n                \"less than\",\n                \"less than or equal\",\n                \"greater than\",\n                \"greater than or equal\",\n            ],\n            info=\"The operator to apply for comparing the texts.\",\n            value=\"equals\",\n            real_time_refresh=True,\n        ),\n        MessageTextInput(\n            name=\"match_text\",\n            display_name=\"Match Text\",\n            info=\"The text input to compare against.\",\n            required=True,\n        ),\n        BoolInput(\n            name=\"case_sensitive\",\n            display_name=\"Case Sensitive\",\n            info=\"If true, the comparison will be case sensitive.\",\n            value=True,\n            advanced=True,\n        ),\n        MessageInput(\n            name=\"true_case_message\",\n            display_name=\"Case True\",\n            info=\"The message to pass if the condition is True.\",\n            advanced=True,\n        ),\n        MessageInput(\n            name=\"false_case_message\",\n            display_name=\"Case False\",\n            info=\"The message to pass if the condition is False.\",\n            advanced=True,\n        ),\n        IntInput(\n            name=\"max_iterations\",\n            display_name=\"Max Iterations\",\n            info=\"The maximum number of iterations for the conditional router.\",\n            value=10,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"default_route\",\n            display_name=\"Default Route\",\n            options=[\"true_result\", \"false_result\"],\n            info=\"The default route to take when max iterations are reached.\",\n            value=\"false_result\",\n            advanced=True,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"True\", name=\"true_result\", method=\"true_response\", group_outputs=True),\n        Output(display_name=\"False\", name=\"false_result\", method=\"false_response\", group_outputs=True),\n    ]\n\n    def _pre_run_setup(self):\n        self.__iteration_updated = False\n\n    def evaluate_condition(self, input_text: str, match_text: str, operator: str, *, case_sensitive: bool) -> bool:\n        if not case_sensitive and operator != \"regex\":\n            input_text = input_text.lower()\n            match_text = match_text.lower()\n\n        if operator == \"equals\":\n            return input_text == match_text\n        if operator == \"not equals\":\n            return input_text != match_text\n        if operator == \"contains\":\n            return match_text in input_text\n        if operator == \"starts with\":\n            return input_text.startswith(match_text)\n        if operator == \"ends with\":\n            return input_text.endswith(match_text)\n        if operator == \"regex\":\n            try:\n                return bool(re.match(match_text, input_text))\n            except re.error:\n                return False  # Return False if the regex is invalid\n        if operator in [\"less than\", \"less than or equal\", \"greater than\", \"greater than or equal\"]:\n            try:\n                input_num = float(input_text)\n                match_num = float(match_text)\n                if operator == \"less than\":\n                    return input_num < match_num\n                if operator == \"less than or equal\":\n                    return input_num <= match_num\n                if operator == \"greater than\":\n                    return input_num > match_num\n                if operator == \"greater than or equal\":\n                    return input_num >= match_num\n            except ValueError:\n                return False  # Invalid number format for comparison\n        return False\n\n    def iterate_and_stop_once(self, route_to_stop: str):\n        \"\"\"Handles cycle iteration counting and branch exclusion.\n\n        Uses two complementary mechanisms:\n        1. stop() - ACTIVE/INACTIVE state for cycle management (gets reset each iteration)\n        2. exclude_branch_conditionally() - Persistent exclusion for conditional routing\n\n        When max_iterations is reached, breaks the cycle by allowing the default_route to execute.\n        \"\"\"\n        if not self.__iteration_updated:\n            self.update_ctx({f\"{self._id}_iteration\": self.ctx.get(f\"{self._id}_iteration\", 0) + 1})\n            self.__iteration_updated = True\n            current_iteration = self.ctx.get(f\"{self._id}_iteration\", 0)\n\n            # Check if max iterations reached and we're trying to stop the default route\n            if current_iteration >= self.max_iterations and route_to_stop == self.default_route:\n                # Clear ALL conditional exclusions to allow default route to execute\n                if self._id in self.graph.conditional_exclusion_sources:\n                    previous_exclusions = self.graph.conditional_exclusion_sources[self._id]\n                    self.graph.conditionally_excluded_vertices -= previous_exclusions\n                    del self.graph.conditional_exclusion_sources[self._id]\n\n                # Switch which route to stop - stop the NON-default route to break the cycle\n                route_to_stop = \"true_result\" if route_to_stop == \"false_result\" else \"false_result\"\n\n                # Call stop to break the cycle\n                self.stop(route_to_stop)\n                # Don't apply conditional exclusion when breaking cycle\n                return\n\n            # Normal case: Use BOTH mechanisms\n            # 1. stop() for cycle management (marks INACTIVE, updates run manager, gets reset)\n            self.stop(route_to_stop)\n\n            # 2. Conditional exclusion for persistent routing (doesn't get reset except by this router)\n            self.graph.exclude_branch_conditionally(self._id, output_name=route_to_stop)\n\n    def true_response(self) -> Message:\n        result = self.evaluate_condition(\n            self.input_text, self.match_text, self.operator, case_sensitive=self.case_sensitive\n        )\n\n        # Check if we should force output due to max_iterations on default route\n        current_iteration = self.ctx.get(f\"{self._id}_iteration\", 0)\n        force_output = current_iteration >= self.max_iterations and self.default_route == \"true_result\"\n\n        if result or force_output:\n            self.status = self.true_case_message\n            if not force_output:  # Only stop the other branch if not forcing due to max iterations\n                self.iterate_and_stop_once(\"false_result\")\n            return self.true_case_message\n        self.iterate_and_stop_once(\"true_result\")\n        return Message(content=\"\")\n\n    def false_response(self) -> Message:\n        result = self.evaluate_condition(\n            self.input_text, self.match_text, self.operator, case_sensitive=self.case_sensitive\n        )\n\n        if not result:\n            self.status = self.false_case_message\n            self.iterate_and_stop_once(\"true_result\")\n            return self.false_case_message\n\n        self.iterate_and_stop_once(\"false_result\")\n        return Message(content=\"\")\n\n    def update_build_config(self, build_config: dict, field_value: str, field_name: str | None = None) -> dict:\n        if field_name == \"operator\":\n            if field_value == \"regex\":\n                build_config.pop(\"case_sensitive\", None)\n            elif \"case_sensitive\" not in build_config:\n                case_sensitive_input = next(\n                    (input_field for input_field in self.inputs if input_field.name == \"case_sensitive\"), None\n                )\n                if case_sensitive_input:\n                    build_config[\"case_sensitive\"] = case_sensitive_input.to_dict()\n        return build_config\n"
        },
        "default_route": {
          "_input_type": "DropdownInput",
          "advanced": true,
          "combobox": false,
          "dialog_inputs": {},
          "display_name": "Default Route",
          "dynamic": false,
          "external_options": {},
          "info": "The default route to take when max iterations are reached.",
          "name": "default_route",
          "options": [
            "true_result",
            "false_result"
          ],
          "options_metadata": [],
          "placeholder": "",
          "required": false,
          "show": true,
          "title_case": false,
          "toggle": false,
          "tool_mode": false,
          "trace_as_metadata": true,
          "type": "str",
          "value": "false_result"
        },
        "false_case_message": {
          "_input_type": "MessageInput",
          "advanced": true,
          "display_name": "Case False",
          "dynamic": false,
          "info": "The message to pass if the condition is False.",
          "input_types": [
            "Message"
          ],
          "list": false,
          "list_add_label": "Add More",
          "load_from_db": false,
          "name": "false_case_message",
          "placeholder": "",
          "required": false,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_input": true,
          "trace_as_metadata": true,
          "type": "str",
          "value": ""
        },
        "input_text": {
          "_input_type": "MessageTextInput",
          "advanced": false,
          "display_name": "Text Input",
          "dynamic": false,
          "info": "The primary text input for the operation.",
          "input_types": [
            "Message"
          ],
          "list": false,
          "list_add_label": "Add More",
          "load_from_db": false,
          "name": "input_text",
          "placeholder": "",
          "required": true,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_input": true,
          "trace_as_metadata": true,
          "type": "str",
          "value": ""
        },
        "match_text": {
          "_input_type": "MessageTextInput",
          "advanced": false,
          "display_name": "Match Text",
          "dynamic": false,
          "info": "The text input to compare against.",
          "input_types": [
            "Message"
          ],
          "list": false,
          "list_add_label": "Add More",
          "load_from_db": false,
          "name": "match_text",
          "placeholder": "",
          "required": true,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_input": true,
          "trace_as_metadata": true,
          "type": "str",
          "value": ""
        },
        "max_iterations": {
          "_input_type": "IntInput",
          "advanced": true,
          "display_name": "Max Iterations",
          "dynamic": false,
          "info": "The maximum number of iterations for the conditional router.",
          "list": false,
          "list_add_label": "Add More",
          "name": "max_iterations",
          "placeholder": "",
          "required": false,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_metadata": true,
          "type": "int",
          "value": 10
        },
        "operator": {
          "_input_type": "DropdownInput",
          "advanced": false,
          "combobox": false,
          "dialog_inputs": {},
          "display_name": "Operator",
          "dynamic": false,
          "external_options": {},
          "info": "The operator to apply for comparing the texts.",
          "name": "operator",
          "options": [
            "equals",
            "not equals",
            "contains",
            "starts with",
            "ends with",
            "regex",
            "less than",
            "less than or equal",
            "greater than",
            "greater than or equal"
          ],
          "options_metadata": [],
          "placeholder": "",
          "real_time_refresh": true,
          "required": false,
          "show": true,
          "title_case": false,
          "toggle": false,
          "tool_mode": false,
          "trace_as_metadata": true,
          "type": "str",
          "value": "equals"
        },
        "true_case_message": {
          "_input_type": "MessageInput",
          "advanced": true,
          "display_name": "Case True",
          "dynamic": false,
          "info": "The message to pass if the condition is True.",
          "input_types": [
            "Message"
          ],
          "list": false,
          "list_add_label": "Add More",
          "load_from_db": false,
          "name": "true_case_message",
          "placeholder": "",
          "required": false,
          "show": true,
          "title_case": false,
          "tool_mode": false,
          "trace_as_input": true,
          "trace_as_metadata": true,
          "type": "str",
          "value": ""
        }
      },
      "tool_mode": false
    },
    "showNode": true,
    "type": "ConditionalRouter"
  },
  "dragging": false,
  "id": "ConditionalRouter-JcNLx",
  "measured": {
    "height": 429,
    "width": 320
  },
  "position": {
    "x": 759.5043521801891,
    "y": -26.116011785987666
  },
  "selected": false,
  "type": "genericNode"
}